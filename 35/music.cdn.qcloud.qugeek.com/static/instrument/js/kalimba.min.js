!function(e){function t(e,t){this.el=e,this.tines=[].slice.call(this.el.querySelectorAll(".kalimba__tine")),this.midiCode=108,this._initEvents()}t.prototype._initEvents=function(){var e=this,t=mobilecheck(),n={down:t?"touchstart":"mousedown",up:t?"touchend":"mouseup"};this.tines.forEach(function(o){o.addEventListener(n.down,function(n){var i=e._getNote(o);e.mdown=!0,t||(e.mouseLeaveFn=function(t){e._play(i,"off"),this.removeEventListener("mouseleave",e.mouseLeaveFn)},o.addEventListener("mouseleave",e.mouseLeaveFn)),e._play(i,"on",o)}),o.addEventListener(n.up,function(n){if(!e.mdown&&!t)return!1;e.mdown=!1;var i=e._getNote(o);t||this.removeEventListener("mouseleave",e.mouseLeaveFn),e._play(i,"off")}),t||o.addEventListener("mouseenter",function(t){if(!e.mdown)return!1;var n=e._getNote(o);e.mouseLeaveFn=function(t){e._play(n,"off"),this.removeEventListener("mouseleave",e.mouseLeaveFn)},o.addEventListener("mouseleave",e.mouseLeaveFn),e._play(n,"on",o)})}),t||(this.el.addEventListener("mousedown",function(t){e.mdown=!0}),this.el.addEventListener("mouseup",function(t){e.mdown=!1}),this.el.addEventListener("mouseleave",function(t){e.mdown=!1}))},t.prototype._getNote=function(e){return e.getAttribute("note:id")},t.prototype._play=function(e,t,n){e=parseInt(e)+21;MIDI.programChange(0,this.midiCode),"on"===t?(MIDI.noteOn(0,e,127,0),anime({targets:n,duration:1500,easing:"easeOutElastic",elasticity:900,translateY:[-3,0]})):MIDI.noteOff(0,e,4)},e.Kalimba=t}(window);